(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{263:function(r,a,t){r.exports=t.p+"assets/img/cache-1.515586b8.png"},264:function(r,a,t){r.exports=t.p+"assets/img/cache-2.852624b9.png"},279:function(r,a,t){"use strict";t.r(a);var e=t(38),n=Object(e.a)({},function(){var r=this,a=r.$createElement,e=r._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[e("h1",{attrs:{id:"缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存","aria-hidden":"true"}},[r._v("#")]),r._v(" 缓存")]),r._v(" "),e("h2",{attrs:{id:"浏览器缓存：强缓存和协商缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器缓存：强缓存和协商缓存","aria-hidden":"true"}},[r._v("#")]),r._v(" 浏览器缓存：强缓存和协商缓存")]),r._v(" "),e("h4",{attrs:{id:"场景描述（为加深理解写的小故事，不感兴趣可跳过哦）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#场景描述（为加深理解写的小故事，不感兴趣可跳过哦）","aria-hidden":"true"}},[r._v("#")]),r._v(" 场景描述（为加深理解写的小故事，不感兴趣可跳过哦）")]),r._v(" "),e("p",[r._v("AA ———— 一个有电脑的普通人。"),e("br"),r._v("\nLL ———— AA电脑上唯一的浏览器。\n现在我们把AA的浏览器LL拟人化。LL是AA的仆人。"),e("br"),r._v("\nAA：LL，给我打开www.bb.com！我要看小说。"),e("br"),r._v("\nLL：好嘞主人，马上就来！"),e("br"),r._v("\nLL是一个聪明又敬业的仆人。因为AA总是让他打开网页，所以他有自己的一套应对办法。"),e("br"),r._v("\nLL在自己身上装了一个小本子。每当AA让他打开页面的时候，他都会把这个页面的信息记下来。LL和服务器是好基友，他们约定了一套规则来给彼此减轻工作负担。"),e("br"),r._v("\n这个规则是这样的："),e("br"),r._v("\n每当LL要打开一个页面前，先到自己的小本子上看一下，是不是有这个页面的记录？如果有，看一下这条记录过期时间。"),e("br"),r._v("\n如果没有过期，LL就直接把这个页面拿给AA，不用再打电话让服务器传过来了。"),e("br"),r._v("\n如果过期了，LL就打电话给服务器说：我家主人要这个页面，我这里存储的这个页面的tag是12，快帮我看看这个页面现在的tag是多少，没改我直接给他这个页面，你不用传来了。改了的话你就把最新的页面传给我，我把最新的tag和页面记上。"),e("br"),r._v("\n如果压根没有这个页面的记录，那LL就会直接打电话跟服务器说：我家主人现在要这个页面，我这没有这个页面的记录，快给我最新的页面和tag，我拿给他顺便存一下。")]),r._v(" "),e("h4",{attrs:{id:"场景分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#场景分析","aria-hidden":"true"}},[r._v("#")]),r._v(" 场景分析")]),r._v(" "),e("h4",{attrs:{id:"浏览器为什么要有缓存策略？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器为什么要有缓存策略？","aria-hidden":"true"}},[r._v("#")]),r._v(" 浏览器为什么要有缓存策略？")]),r._v(" "),e("ol",[e("li",[r._v("更快的响应用户（主人），减少不必要的与服务器交流的时间，以及带宽传输数据的时间。")]),r._v(" "),e("li",[r._v("节约用户流量（电话费），减少不必要的数据传输流量。")]),r._v(" "),e("li",[r._v("为服务器（好基友）减少压力——如果走了强缓存压根都不用向服务器发起请求，如果走了协商缓存也只需要服务器返回respondheader\n以上为用户和服务器都来了很大好处。")])]),r._v(" "),e("h4",{attrs:{id:"浏览器的缓存策略经过哪些步骤？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的缓存策略经过哪些步骤？","aria-hidden":"true"}},[r._v("#")]),r._v(" 浏览器的缓存策略经过哪些步骤？")]),r._v(" "),e("p",[r._v("总结流程图如下：\n"),e("img",{attrs:{src:t(263),alt:"浏览器缓存流程图"}})]),r._v(" "),e("h4",{attrs:{id:"用户怕浏览器缓存有问题，想跳过浏览器的缓存策略可以怎么做？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用户怕浏览器缓存有问题，想跳过浏览器的缓存策略可以怎么做？","aria-hidden":"true"}},[r._v("#")]),r._v(" 用户怕浏览器缓存有问题，想跳过浏览器的缓存策略可以怎么做？")]),r._v(" "),e("p",[r._v("F5刷新或者点击浏览器工具栏刷新按钮，会跳过强缓存。"),e("br"),r._v("\ncontrol+F5会跳过强缓存和协商缓存，重新获取资源。"),e("br"),r._v("\n通过浏览器历史记录，清除浏览数据。")]),r._v(" "),e("h4",{attrs:{id:"缓存存在了哪里？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存存在了哪里？","aria-hidden":"true"}},[r._v("#")]),r._v(" 缓存存在了哪里？")]),r._v(" "),e("ul",[e("li",[r._v("disk cache\n"),e("ul",[e("li",[r._v("存储在硬盘中的缓存，资源相对稳定，不会随着tab或浏览器的关闭而消失，用来存储大型的，需要长久使用的资源。当硬盘中的资源被加载时，内存中也存储了该资源，当下次改资源被调用时，会优先从memory cache中读取，加快资源的获取")])])]),r._v(" "),e("li",[r._v("memory cache\n"),e("ul",[e("li",[r._v("存储在内存中的缓存，内存中的内容会随着tab的关闭而释放。")])])])]),r._v(" "),e("p",[r._v("当你访问chrome中的URL时，页面上的HTML和其他资源（如图像）将本地存储在内存和磁盘缓存中。Chrome将首先使用内存缓存，因为它的速度快得多，但它也会将页面存储在磁盘缓存中，以防您退出浏览器或它崩溃，因为磁盘缓存是持久的。")]),r._v(" "),e("ul",[e("li",[r._v("三级缓存原理\n"),e("ul",[e("li",[r._v("先去内存看，如果有，直接加载")]),r._v(" "),e("li",[r._v("如果内存没有，择取硬盘获取，如果有直接加载")]),r._v(" "),e("li",[r._v("如果硬盘也没有，那么就进行网络请求")]),r._v(" "),e("li",[r._v("加载到的资源缓存到硬盘和内存，下次请求可以快速从内存中获取到")])])])]),r._v(" "),e("h4",{attrs:{id:"怎么合理应用浏览器缓存？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#怎么合理应用浏览器缓存？","aria-hidden":"true"}},[r._v("#")]),r._v(" 怎么合理应用浏览器缓存？")]),r._v(" "),e("p",[r._v("强制缓存优先级最高，并且资源的改动在缓存有效期内都不会对缓存产生影响，因此该方法适用于大型且不易修改的的资源文件，例如第三方CSS、JS文件或图片资源，文件后可以加上hash进行版本的区分。建议将此类大型资源存入disk cache，因为存在硬盘中的文件资源不易丢失。比如静态网站的js、css文件等。")]),r._v(" "),e("p",[r._v("协商缓存灵活性高，适用于数据的缓存，采用Etag标识进行对比灵活度最高，并考虑将数据存入内存中，因为内存加载速最快，并且数据体积小，不会占用大量内存资源。比如静态网站的html入口文件。")]),r._v(" "),e("h2",{attrs:{id:"cdn缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cdn缓存","aria-hidden":"true"}},[r._v("#")]),r._v(" CDN缓存")]),r._v(" "),e("h4",{attrs:{id:"场景描述（为加深理解写的小故事，不感兴趣可跳过哦）-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#场景描述（为加深理解写的小故事，不感兴趣可跳过哦）-2","aria-hidden":"true"}},[r._v("#")]),r._v(" 场景描述（为加深理解写的小故事，不感兴趣可跳过哦）")]),r._v(" "),e("p",[r._v("AA：LL，打开www.cc.com，我要看最新的cc江湖录！"),e("br"),r._v("\nLL：好的主人，马上就给你！"),e("br"),r._v("\nLL给CC打电话，发现CC远在万里之外，连通花的时间多了点。而且CC网站上刚有一位亿万级作者更新小说，现在给他打电话的超级多，导致回应也略慢了些。"),e("br"),r._v("\nLL办完正事后：CC老兄，你这样也太累了，能不能在咱俩中间设个站点NN，我问NN要东西，他再问你要得了。"),e("br"),r._v("\nCC：你这方案也不顶事呀，我的工作量貌似并没有减少多少，除了距离短了些。"),e("br"),r._v("\nLL：你傻呀，咱俩都能搞个办法缓存，就不能让NN也存上，没过期就直接传给我，你不轻省多了。"),e("br"),r._v("\nCC：好主意！就这么办吧！")]),r._v(" "),e("h4",{attrs:{id:"场景分析-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#场景分析-2","aria-hidden":"true"}},[r._v("#")]),r._v(" 场景分析")]),r._v(" "),e("h4",{attrs:{id:"cdn的缓存策略是什么样的？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cdn的缓存策略是什么样的？","aria-hidden":"true"}},[r._v("#")]),r._v(" CDN的缓存策略是什么样的？")]),r._v(" "),e("p",[r._v("cdn缓存策略与上文中浏览器的强缓存策略相似。CDN边缘节点接收到请求后，会检测自己是否有该资源的缓存，以及该资源是否过期。如未过期，直接返回给浏览器。若过期，向源站服务器请求新的资源并缓存下来。"),e("br"),r._v("\nCDN边缘节点缓存策略因服务商不同而不同，但一般都会遵循http标准协议，通过http响应头中的Cache-control: max-age的字段来设置CDN边缘节点数据缓存时间。")]),r._v(" "),e("h4",{attrs:{id:"使用cdn缓存后，一个完整的请求过程是怎样的？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用cdn缓存后，一个完整的请求过程是怎样的？","aria-hidden":"true"}},[r._v("#")]),r._v(" 使用CDN缓存后，一个完整的请求过程是怎样的？")]),r._v(" "),e("p",[r._v("总结流程图如下：\n"),e("img",{attrs:{src:t(264),alt:"使用CDN缓存的请求流程图"}})]),r._v(" "),e("h4",{attrs:{id:"使用cdn分发有什么好处？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用cdn分发有什么好处？","aria-hidden":"true"}},[r._v("#")]),r._v(" 使用CDN分发有什么好处？")]),r._v(" "),e("ol",[e("li",[r._v("为用户非配最近，负载最小的服务器，降低访问延时，更快的响应用户，更小的流量消耗。")]),r._v(" "),e("li",[r._v("为源站服务器分流减压。")])]),r._v(" "),e("h4",{attrs:{id:"将资源放到cdn上需要注意什么？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#将资源放到cdn上需要注意什么？","aria-hidden":"true"}},[r._v("#")]),r._v(" 将资源放到CDN上需要注意什么？")]),r._v(" "),e("p",[r._v("更新问题：当源站更新文件后，缓存服务器很可能因为缓存的过期时间未到而不向源站服务器请求。这导致返回给浏览器的仍然是旧文件。所以源站在更新文件时，应手动刷新资源。静态页面引用的资源，应以hash名方式发布。")]),r._v(" "),e("h3",{attrs:{id:"参考文章"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文章","aria-hidden":"true"}},[r._v("#")]),r._v(" 参考文章")]),r._v(" "),e("p",[e("a",{attrs:{href:"https://www.jianshu.com/p/9c95db596df5",target:"_blank",rel:"noopener noreferrer"}},[r._v("彻底弄懂强缓存与协商缓存"),e("OutboundLink")],1),e("br"),r._v(" "),e("a",{attrs:{href:"https://juejin.im/post/5c417993f265da61285a6075",target:"_blank",rel:"noopener noreferrer"}},[r._v("前端之浏览器缓存，一次搞定"),e("OutboundLink")],1),e("br"),r._v(" "),e("a",{attrs:{href:"https://www.jianshu.com/p/47f3406c8084",target:"_blank",rel:"noopener noreferrer"}},[r._v("浏览器缓存、HTTP缓存（强缓存、协商缓存），浏览器缓存和CDN的关系"),e("OutboundLink")],1),e("br"),r._v(" "),e("a",{attrs:{href:"https://segmentfault.com/a/1190000017930248",target:"_blank",rel:"noopener noreferrer"}},[r._v("从前端角度理解缓存"),e("OutboundLink")],1),e("br"),r._v(" "),e("a",{attrs:{href:"https://juejin.im/post/5ae081aaf265da0b767d263a",target:"_blank",rel:"noopener noreferrer"}},[r._v("你应该知道的前端——缓存"),e("OutboundLink")],1),e("br"),r._v(" "),e("a",{attrs:{href:"https://www.cnblogs.com/blogbyhuer/p/9335257.html",target:"_blank",rel:"noopener noreferrer"}},[r._v("关于CDN与缓存（浏览器和CDN）"),e("OutboundLink")],1)])])},[],!1,null,null,null);a.default=n.exports}}]);